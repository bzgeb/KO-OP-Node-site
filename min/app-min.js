function subscribe(e,r,s){api.listSubscribe({id:mc_newsletter_id,email_address:e,merge_vars:{EMAIL:e,FNAME:"",LNAME:"",GROUPINGS:[{id:8953,groups:r}]}},function(i,a){if(i){var o="";console.log(i.code),502==i.code?o="Subscription failed.  Please verify that your email address is correct.":214==i.code&&(o="You've been added to the "+r+" group.",api.listUpdateMember({id:mc_newsletter_id,email_address:e,merge_vars:{EMAIL:e,GROUPINGS:[{id:8953,groups:r}]},replace_interests:!1},function(e,r){console.log(e?e.message:JSON.stringify(r))})),s.send("<p>"+o+"</p>")}else console.log(JSON.stringify(a)),s.send("<p>You are subscribed.  Please check your email for a confirmation.</p>")})}try{var configs=require("./configs")}catch(error){}var express=require("express"),stylus=require("stylus"),nib=require("nib"),MailChimpAPI=require("mailchimp").MailChimpAPI,mc_api_key=process.env.MC_API_KEY,mc_newsletter_id=process.env.MC_NEWSLETTER_ID,mc_interest_group="General All Purpose";try{var api=new MailChimpAPI(mc_api_key,{version:"1.3",secure:!1})}catch(error){console.log(error.message)}var app=express.createServer();app.configure(function(){app.use(express["static"](__dirname+"/public")),app.use(express.bodyParser()),app.set("views",__dirname),app.register(".html",{compile:function(e,r){return function(r){return e}}})}),app.get("/",function(e,r){r.render("index.html",{layout:!1})}),app.get("/store",function(e,r){r.render("store.html",{layout:!1})}),app.get("/games",function(e,r){r.render("games.html",{layout:!1})}),app.get("/kolab",function(e,r){r.render("kolab.html",{layout:!1})}),app.get("/workshops",function(e,r){r.render("workshops.html",{layout:!1})}),app.get("/gardenarium",function(e,r){r.render("gardenarium.html",{layout:!1})}),app.post("/mailing_list/subscribe",function(e,r){var s=e.body.email;subscribe(s,mc_interest_group,r)}),app.post("/mailing_list/subscribe_general",function(e,r){var s=e.body.email;subscribe(s,"General All Purpose",r)});var port=process.env.PORT||3e3;app.listen(port,function(){var e=app.address();console.log("   app listening on http://"+e.address+":"+e.port)});